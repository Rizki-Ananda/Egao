<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Egao</title>
    <meta charset="utf-8" />
  </head>
  <body style="background-color: black">
    <h1 style="color: cornsilk">Upload Your Image</h1>

    <form action="/upload" method="post" enctype="multipart/form-data">
      <input type="file" accept="image/*" name="photo" />
      <button type="button" onclick="submitClick()">upload</button>
    </form>

    <h1 style="color: cornsilk">Images</h1>
    <div id="images"></div>
  </body>

  <script>
    const submitClick = () => {
      const formData = new FormData();
      const fileField = document.querySelector('input[type="file"]');

      formData.append("photo", fileField.files[0]);

      fetch("/upload", {
        method: "POST",
        body: formData,
      })
        .then((response) => response.json())
        .then((result) => {
          console.log("Success:", result);
          const images = document.getElementById("images");
          const img = document.createElement("img");
          img.src = `/edited/${result.filename}`;

          images.appendChild(img);
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    };
  </script>
</html>
